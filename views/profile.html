<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Gears Publication - User Profile</title>

    <link href="/assets/img/favicon.png" rel="icon" />
    <link href="/assets/img/apple-touch-icon.png" rel="apple-touch-icon" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,600;1,700&family=Montserrat:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Raleway:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
        rel="stylesheet" />

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/glightbox@3.2.0/dist/css/glightbox.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/swiper@9.3.2/swiper-bundle.min.css" rel="stylesheet" />

    <link href="/assets/css/main.css" rel="stylesheet" />
    <link rel="stylesheet" href="/static/css/style.css" />
</head>

<body>
    <section id="topbar" class="topbar d-flex align-items-center">
        <div class="container d-flex justify-content-center justify-content-md-between">
            <div class="contact-info d-flex align-items-center">
                Write without Favor, Express without Fear
            </div>
            <div class="social-links d-none d-md-flex align-items-center">
                Follow us on Facebook!
                <a href="https://www.facebook.com/TheGearsOfficial" class="facebook"><i class="bi bi-facebook"></i></a>
            </div>
        </div>
    </section>

    <header id="header" class="header d-flex align-items-center">
        <div class="container-fluid container-xl d-flex align-items-center justify-content-between">
            <a href="/" class="logo d-flex align-items-center">
                <img src="/assets/img/logo.jpg" alt="" />
                <h3>The Gears Publication<span>.</span></h3>
            </a>
            <nav id="navbar" class="navbar">
                <ul>
                    <li><a href="#hero">Home</a></li>
                    <li><a href="/news">News</a></li>
                    <li><a href="/events">Events</a></li>
                    <li><a href="/forum">Forum</a></li>
                    <li><a href="/about">About</a></li>
                    <li><a href="/contact">Contact</a></li>
                    <li id="auth"><a href="/auth">Log In / Register</a></li>
                </ul>
            </nav>

            <i class="mobile-nav-toggle mobile-nav-show bi bi-list"></i>
            <i class="mobile-nav-toggle mobile-nav-hide d-none bi bi-x"></i>
        </div>
    </header>

    <main id="main">
        <div class="breadcrumbs">
            <nav>
                <div class="container">
                    <ol>
                        <li><a href="/">Home</a></li>
                        <li>User Profile</li>
                    </ol>
                </div>
            </nav>
        </div>
        <div class="container">
            <h1 class="my-4" id="user_uname">User Profile</h1>

            <!-- Display User Profile -->
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">User Information</h5><br>
                    <p class="card-text">Name: <strong id="user_name">John Doe</strong></p>
                    <p class="card-text">Email: <strong id="user_email">johndoe@example.com</strong></p>
                    <a href="#" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#editProfileModal">Edit
                        Profile</a>
                    <a href="#" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#changePasswordModal">Change Password</a>
                    <a href="#" class="btn btn-danger" data-bs-toggle="modal"
                        data-bs-target="#deleteProfileModal">Delete Profile</a>
                </div>
            </div>

            <!-- Edit Profile Modal -->
            <div class="modal fade" id="editProfileModal" tabindex="-1" aria-labelledby="editProfileModalLabel"
                aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="editProfileModalLabel">Edit Profile</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form>
                                <div class="mb-3">
                                    <label for="editFName" class="form-label">First Name</label>
                                    <input type="text" class="form-control" id="editFName" placeholder="leave empty if unchanged">
                                </div>
                                <div class="mb-3">
                                    <label for="editLName" class="form-label">Last Name</label>
                                    <input type="text" class="form-control" id="editLName" placeholder="leave empty if unchanged">
                                </div>
                                <div class="mb-3">
                                    <label for="editEmail" class="form-label">Email</label>
                                    <input type="email" class="form-control" id="editEmail" placeholder="leave empty if unchanged">
                                </div>
                                <button type="submit" class="btn btn-primary">Save Changes</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Change Password Modal -->
            <div class="modal fade" id="changePasswordModal" tabindex="-1" aria-labelledby="changePasswordModalLabel"
                aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="changePasswordModalLabel">Change Password</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form>
                                <div class="mb-3">
                                    <label for="changePass" class="form-label">New Password</label>
                                    <input type="text" class="form-control" id="changePass">
                                </div>
                                <div class="mb-3">
                                    <label for="changeRPass" class="form-label">Repeat Password</label>
                                    <input type="email" class="form-control" id="changeRPass">
                                </div>
                                <button type="submit" class="btn btn-primary">Save Changes</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Delete Profile Modal -->
            <div class="modal fade" id="deleteProfileModal" tabindex="-1" aria-labelledby="deleteProfileModalLabel"
                aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="deleteProfileModalLabel">Delete Profile</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <p>Are you sure you want to delete your profile?</p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-danger" onclick="deleteProfile();">Delete</button>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"></script>
        <script>
            fetch("/auth/check")
                .then((res) => res.text())
                .then((text) => {
                    if (text != "0") {
                        document.getElementById("auth").innerHTML = text;
                    }
                });
            fetch("/get_profile")
                .then((res) => res.json())
                .then((json) => {
                    const jsonProfile = JSON.stringify(json);
                    const profile = JSON.parse(jsonProfile);
                    document.getElementById("user_uname").innerHTML = profile[0].uname;
                    document.getElementById("user_name").innerHTML = `${profile[0].fname} ${profile[0].lname}`;
                    document.getElementById("user_email").innerHTML = profile[0].email;
                });
            function deleteProfile() {
                fetch("/delete_profile", {method: 'POST'})
                    .then((res) => res.text())
                    .then((text) => {
                        if (text == "1") {
                            alert("Deleted successfully!");
                            window.location.replace("/auth/logout");
                        }
                    });
            }
        </script>
</body>

</html>